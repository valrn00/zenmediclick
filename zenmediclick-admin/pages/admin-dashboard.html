<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administraci√≥n - ZenMediClick</title>
    <link rel="stylesheet" href="../shared/styles/global.css">
    <link rel="stylesheet" href="../styles/admin-dashboard.css">
</head>
<body>
    <div class="admin-container">
        <!-- Header del Administrador -->
        <div class="admin-header">
            <div class="admin-title">
                <span style="font-size: 3rem;">‚öôÔ∏è</span>
                <div>
                    <h1>Panel de Administraci√≥n</h1>
                    <p style="color: #666; font-size: 1.1rem;">Gesti√≥n completa del sistema ZenMediClick</p>
                </div>
            </div>
            <div class="admin-info">
                <div style="font-weight: 600; font-size: 1.1rem;">Admin Principal</div>
                <div style="font-size: 14px;">admin@zenmediclick.com</div>
                <div style="font-size: 14px; margin-top: 5px;">üîí Sesi√≥n segura activa</div>
            </div>
        </div>

        <!-- Grid Principal -->
        <div class="admin-grid">
            <!-- Gestionar Usuarios -->
            <div class="admin-card card-users">
                <div class="card-header">
                    <h3 class="card-title">üë• Gestionar Usuarios</h3>
                    <span class="card-icon">üë•</span>
                </div>

                <!-- Agregar Usuario -->
                <div class="form-section">
                    <button class="btn btn-primary" onclick="showAddUserModal()" style="width: 100%; margin-bottom: 20px;">
                        ‚ûï Agregar Usuario
                    </button>

                    <!-- Buscar Usuario -->
                    <div class="search-container">
                        <input type="text" id="searchUser" class="search-input" placeholder="Buscar usuario...">
                        <button class="btn btn-secondary" onclick="searchUsers()">üîç Buscar</button>
                    </div>

                    <!-- Tabla de Usuarios -->
                    <div style="max-height: 300px; overflow-y: auto;">
                        <table class="users-table">
                            <thead>
                                <tr>
                                    <th>Nombre</th>
                                    <th>Rol</th>
                                    <th>Estado</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody">
                                <tr>
                                    <td>Juan P√©rez</td>
                                    <td><span class="status-badge" style="background: #e3f2fd; color: #1976d2;">M√©dico</span></td>
                                    <td><span class="status-badge status-active">Activo</span></td>
                                    <td>
                                        <button class="btn btn-warning btn-small" onclick="editUser('juan')">‚úèÔ∏è Editar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Ana Torres</td>
                                    <td><span class="status-badge" style="background: #f3e5f5; color: #7b1fa2;">Paciente</span></td>
                                    <td><span class="status-badge status-inactive">Inactivo</span></td>
                                    <td>
                                        <button class="btn btn-success btn-small" onclick="activateUser('ana')">‚úÖ Activar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Dr. Carlos Rodr√≠guez</td>
                                    <td><span class="status-badge" style="background: #e3f2fd; color: #1976d2;">M√©dico</span></td>
                                    <td><span class="status-badge status-active">Activo</span></td>
                                    <td>
                                        <button class="btn btn-warning btn-small" onclick="editUser('carlos')">‚úèÔ∏è Editar</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Mar√≠a Gonz√°lez</td>
                                    <td><span class="status-badge" style="background: #f3e5f5; color: #7b1fa2;">Paciente</span></td>
                                    <td><span class="status-badge status-active">Activo</span></td>
                                    <td>
                                        <button class="btn btn-warning btn-small" onclick="editUser('maria')">‚úèÔ∏è Editar</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Reportes del Sistema -->
            <div class="admin-card card-reports">
                <div class="card-header">
                    <h3 class="card-title">üìä Reportes del Sistema</h3>
                    <span class="card-icon">üìä</span>
                </div>

                <div class="form-section">
                    <div class="form-group">
                        <label>üìÖ Rango de fechas:</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <input type="date" id="reportStartDate" value="2025-01-01">
                            <input type="date" id="reportEndDate" value="2025-09-13">
                        </div>
                    </div>

                    <button class="btn btn-success" onclick="generateReports()" style="width: 100%; margin-bottom: 20px;">
                        üìà Generar Reportes
                    </button>

                    <div class="reports-section">
                        <div class="report-item">
                            <div class="report-info">
                                <div class="report-title">üìÖ Citas m√©dicas por semana</div>
                                <div class="report-description">Reporte detallado de citas programadas y completadas</div>
                            </div>
                            <div class="report-actions">
                                <button class="btn btn-info btn-small" onclick="downloadReport('appointments', 'pdf')">üìÑ PDF</button>
                                <button class="btn btn-success btn-small" onclick="downloadReport('appointments', 'excel')">üìä EXCEL</button>
                            </div>
                        </div>

                        <div class="report-item">
                            <div class="report-info">
                                <div class="report-title">üë• Usuarios registrados</div>
                                <div class="report-description">Estad√≠sticas de registro y actividad de usuarios</div>
                            </div>
                            <div class="report-actions">
                                <button class="btn btn-info btn-small" onclick="downloadReport('users', 'pdf')">üìÑ PDF</button>
                                <button class="btn btn-success btn-small" onclick="downloadReport('users', 'excel')">üìä EXCEL</button>
                            </div>
                        </div>

                        <div class="report-item">
                            <div class="report-info">
                                <div class="report-title">‚ùå Cancelaciones por m√©dico</div>
                                <div class="report-description">An√°lisis de cancelaciones por especialidad m√©dica</div>
                            </div>
                            <div class="report-actions">
                                <button class="btn btn-info btn-small" onclick="downloadReport('cancellations', 'pdf')">üìÑ PDF</button>
                                <button class="btn btn-success btn-small" onclick="downloadReport('cancellations', 'excel')">üìä EXCEL</button>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-secondary" onclick="goToMainPanel()" style="width: 100%; margin-top: 20px;">
                        ‚Ü©Ô∏è Volver al panel principal
                    </button>
                </div>
            </div>
        </div>

        <!-- Configurar Disponibilidad (Ancho completo) -->
        <div class="admin-card card-schedule full-width-card">
            <div class="card-header">
                <h3 class="card-title">üìÖ Configurar Disponibilidad</h3>
                <span class="card-icon">‚è∞</span>
            </div>

            <div class="form-section">
                <div class="form-group">
                    <label>üë®‚Äç‚öïÔ∏è M√©dico:</label>
                    <select id="doctorSelect" style="margin-bottom: 20px;">
                        <option value="">Seleccionar m√©dico...</option>
                        <option value="dr-rodriguez">Dr. Carlos Rodr√≠guez - Cardiolog√≠a</option>
                        <option value="dra-martinez">Dra. Ana Mart√≠nez - Pediatr√≠a</option>
                        <option value="dr-lopez">Dr. Miguel L√≥pez - Neurolog√≠a</option>
                        <option value="dra-garcia">Dra. Laura Garc√≠a - Ginecolog√≠a</option>
                    </select>
                </div>

                <div class="availability-section">
                    <h4 style="margin-bottom: 20px; color: #495057;">‚è∞ Configurar horarios disponibles:</h4>

                    <div class="schedule-grid">
                        <div class="schedule-day">üìÖ Lunes</div>
                        <input type="time" class="schedule-input" id="monday-start" value="08:00">
                        <input type="time" class="schedule-input" id="monday-end" value="12:00">
                    </div>

                    <div class="schedule-grid">
                        <div class="schedule-day">üìÖ Martes</div>
                        <input type="time" class="schedule-input" id="tuesday-start" value="08:00">
                        <input type="time" class="schedule-input" id="tuesday-end" value="12:00">
                    </div>

                    <div class="schedule-grid">
                        <div class="schedule-day">üìÖ Mi√©rcoles</div>
                        <input type="time" class="schedule-input" id="wednesday-start" value="02:00">
                        <input type="time" class="schedule-input" id="wednesday-end" value="06:00">
                    </div>

                    <div class="schedule-grid">
                        <div class="schedule-day">üìÖ Jueves</div>
                        <input type="time" class="schedule-input" id="thursday-start" value="08:00">
                        <input type="time" class="schedule-input" id="thursday-end" value="12:00">
                    </div>

                    <div class="schedule-grid">
                        <div class="schedule-day">üìÖ Viernes</div>
                        <input type="time" class="schedule-input" id="friday-start" value="08:00">
                        <input type="time" class="schedule-input" id="friday-end" value="12:00">
                    </div>

                    <div style="display: flex; gap: 15px; margin-top: 30px; justify-content: center;">
                        <button class="btn btn-primary" onclick="addAvailability()">
                            ‚ûï Agregar Disponibilidad
                        </button>
                        <button class="btn btn-success" onclick="saveScheduleChanges()">
                            üíæ Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Agregar Usuario -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚ûï Agregar Nuevo Usuario</h3>
                <button class="close-btn" onclick="closeModal('addUserModal')">&times;</button>
            </div>

            <form id="addUserForm">
                <div class="form-group">
                    <label>Nombre Completo *</label>
                    <input type="text" id="newUserName" required>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="newUserEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Tel√©fono *</label>
                        <input type="tel" id="newUserPhone" required>
                    </div>
                    <div class="form-group">
                        <label>Rol *</label>
                        <select id="newUserRole" required>
                            <option value="">Seleccionar...</option>
                            <option value="paciente">Paciente</option>
                            <option value="medico">M√©dico</option>
                            <option value="admin">Administrador</option>
                        </select>
                    </div>
                </div>

                <div id="doctorFields" style="display: none;">
                    <div class="form-group">
                        <label>Especialidad</label>
                        <select id="newUserSpecialty">
                            <option value="">Seleccionar especialidad...</option>
                            <option value="cardiologia">Cardiolog√≠a</option>
                            <option value="pediatria">Pediatr√≠a</option>
                            <option value="neurologia">Neurolog√≠a</option>
                            <option value="ginecologia">Ginecolog√≠a</option>
                            <option value="traumatologia">Traumatolog√≠a</option>
                            <option value="dermatologia">Dermatolog√≠a</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>N√∫mero de Licencia M√©dica</label>
                        <input type="text" id="newUserLicense" placeholder="Ej: MP-12345">
                    </div>
                </div>

                <div class="form-group">
                    <label>Contrase√±a Temporal *</label>
                    <input type="password" id="newUserPassword" required>
                    <small style="color: #666;">El usuario deber√° cambiar esta contrase√±a en su primer acceso</small>
                </div>

                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <button type="button" class="btn btn-primary" onclick="saveNewUser()" style="flex: 1;">
                        üíæ Crear Usuario
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('addUserModal')" style="flex: 1;">
                        ‚ùå Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Contenedor de mensajes -->
    <div id="messageContainer" style="position: fixed; top: 20px; right: 20px; z-index: 2000;"></div>

    <!-- Scripts -->
    <script src="../shared/scripts/utils.js"></script>
    <script src="../shared/scripts/constants.js"></script>
    <script src="scripts/user-management.js"></script>
    <script src="scripts/reports.js"></script>
    <script src="scripts/schedule-management.js"></script>
    <script src="scripts/admin-dashboard.js"></script>
</body>
</html>
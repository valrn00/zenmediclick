<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agendar Cita - ZenMediClick</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div class="container">
        <header class="page-header">
            <a href="index.html" class="back-button">← Volver</a>
            <h1>Agendar cita médica</h1>
        </header>
        
        <div class="form-container">
            <form id="agendarForm">
                <div class="form-group">
                    <label for="especialidad">Especialidad :</label>
                    <select id="especialidad" name="especialidad" required>
                        <option value="">Seleccionar</option>
                        <option value="1">Cardiología</option>
                        <option value="2">Neurología</option>
                        <option value="3">Pediatría</option>
                        <option value="4">Medicina General</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="medico">Médico :</label>
                    <select id="medico" name="medico" required>
                        <option value="">Seleccionar especialidad primero</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="fecha">Fecha disponible :</label>
                    <input type="datetime-local" id="fecha" name="fecha" required>
                </div>
                
                <div class="form-group">
                    <label for="motivo">Motivo de consulta :</label>
                    <textarea id="motivo" name="motivo" rows="4" required 
                              placeholder="Describe brevemente el motivo de tu consulta..."></textarea>
                </div>
                
                <button type="submit" class="btn-primary">Confirmar cita</button>
            </form>
        </div>
    </div>
    
    <div id="message" class="message"></div>
    
    <script src="../js/scripts.js"></script>
    <script>
        // Cargar médicos cuando cambie la especialidad
        document.getElementById('especialidad').addEventListener('change', loadMedicos);
        document.getElementById('agendarForm').addEventListener('submit', handleAgendarCita);
        
        // Verificar autenticación
        checkAuth();
    </script>
    <script>
async function agendarCita() {
  const nuevaCita = {
    paciente_id: 1,  // puedes pasar el ID real del paciente logueado
    fecha: "2025-09-20",
    hora: "10:30",
    motivo: "Consulta general"
  };

  const res = await fetch("http://localhost:3000/api/citas", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(nuevaCita)
  });

  const data = await res.json();
  alert(data.message);
}
</script>

<button onclick="agendarCita()">Agendar Cita</button>

</body>
</html>
